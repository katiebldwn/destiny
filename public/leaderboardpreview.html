<!DOCTYPE HTML>
<html>
<head>
	<title>Destiny Reputation Search</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
	<link rel="stylesheet" href="styles.css">
	<link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="76x76" href="icons/apple-touch-icon-76.png">
	<link rel="apple-touch-icon" sizes="120x120" href="icons/apple-touch-icon-120.png">
	<link rel="apple-touch-icon" sizes="152x152" href="icons/apple-touch-icon-152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon-180.png">
	<link rel="icon" sizes="192x192" href="icons/android-touch-icon.png">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<meta name="description" content="Real-time access to any Destiny player's faction reputation & more. No log in required. Check out your friends' reputation, marks, & stats." />
	<meta name="keywords" content="destiny, reputation, rep, check, track, tracking, player, character, search, progress, progression, level, rank, marks, vanguard, crucible, cryptarch, future war cult, new monarchy, dead orbit, event, iron banner, queen, psn, xbox, bungie, game, glimmer, pandapaul, secretpandaman, companion"/>
</head>
<body>

<div class="header">
	<div class="container clearfix">
		<div class="pull-left">
			<a href="/" class="header-link">DESTINY REP</a>
		</div>
		<div class="pull-right google-play-link">
			<a href="https://play.google.com/store/apps/details?id=com.jpapps.repsearch">
			  <img alt="Get it on Google Play" height="39px" src="http://developer.android.com/images/brand/en_generic_rgb_wo_45.png" />
			</a>
		</div>
	</div>
</div>

<div class="leaderboard spa-section">

	<div class="container">
		<h2>Leaderboard Super-Duper Early Preview</h2>
	</div>

	<div class="container description">
	Hey there. This is an in-development preview of a new thing I'm working on for DestinyRep. It's got a long way to go, but check it out.
	</div>

	<div class="container results">
		
	</div>

	<script>
		$(function() {
			var leaderboard = {};

			var container = $('.results');
			container.text('loading...');

			$.ajax({
				url: '/leaderboard', 
				type: 'POST',
				contentType:'application/json; charset=utf-8',
				dataType:'json'
			}).done(function(res){
				container.text('');
				leaderboard = res;
				showLeaderboard();
			}).fail(function(err){
				container.text('something went wrong. but do not worry, this is pre-pre-alpha');
			});

			function showLeaderboard() {
				var membershipTypes = {
					1:'xbox',
					2:'psn'
				};
				$.each(leaderboard, function(i, character) {
					$('<div class="text-left"/>')
						.append((i+1) + '. ')
						.append('<a href="/#un=' + character.membership.displayName + '&t=' + character.membership.type + '">' + character.membership.displayName + '</a>')
						.append(' (' + membershipTypes[character.membership.type] + ')')
						.append(' Cryptarch Rank ' + character.progressions[529303302].level)
						.append(' // ' + character.progressions[529303302].currentProgress)
						.appendTo(container);
				});
			}
		});
	</script>

</div>

</body>
</html>
